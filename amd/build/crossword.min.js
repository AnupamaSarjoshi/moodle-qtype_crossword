/**
 * JavaScript to make crossword question.
 *
 * @module qtype_crossword/crossword
 * @copyright 2022 The Open University
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since 3.11
 */
define("qtype_crossword/crossword",(function(){const ARROW_LEFT="ArrowLeft",ARROW_RIGHT="ArrowRight",ARROW_UP="ArrowUp",ARROW_DOWN="ArrowDown",FILTER_REGEX=/[-@!$%^&*()_+|~=`\\#{}\[\]:";'<>?,.\/]/gi;function CrossWordQuestion(options){let defaultOption={colsNum:10,rowsNum:10,words:[],target:"#crossword",isPreview:!1,previewSetting:{backgroundColor:"#ffffff",borderColor:"#000000",textColor:"#ffffff",conflictColor:"#f4cece"},cellWidth:31,cellHeight:31,wordNumber:-1,coordinates:""};defaultOption={...defaultOption,...options},this.options=defaultOption,this.isPreview=defaultOption.isPreview;const targetEls=document.querySelectorAll(defaultOption.target);for(let i=0;i<targetEls.length;i++)if(!targetEls[i].querySelector("svg")){this.crosswordEl=targetEls[i];break}}CrossWordQuestion.prototype.buildBackgroundTable=function(){const alphabet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];let{colsNum:colsNum,rowsNum:rowsNum,previewSetting:previewSetting}=this.options,style=previewSetting;const tableEl=document.createElement("table");colsNum++,rowsNum++,tableEl.className="crossword-grid",tableEl.style.backgroundColor=style.backgroundColor;for(let i=0;i<rowsNum;i++){const rowEl=document.createElement("tr");rowEl.className="grid-row";for(let j=0;j<colsNum;j++){let squareEl=document.createElement("td");squareEl.className="grid-square",squareEl.style.borderColor=style.borderColor,squareEl.style.color=style.color,0===i&&0===j&&squareEl.classList.add("cell-white"),0===i&&0!==j&&(squareEl.innerText=alphabet[j-1],squareEl.classList.add("square-indicate-horizontal")),0!==i&&0===j&&(squareEl.innerText=i,squareEl.classList.add("square-indicate-vertical")),rowEl.append(squareEl)}tableEl.append(rowEl)}this.tableEl=tableEl,this.crosswordEl.innerHTML=tableEl.outerHTML},CrossWordQuestion.prototype.addCell=function(){let{words:words,previewSetting:previewSetting,rowsNum:rowsNum,colsNum:colsNum}=this.options;if(0!==words.length)for(let i=0;i<words.length;i++){let row=words[i].rowindex+1,column=words[i].columnindex+1,answerLength=words[i].answer.length,realLength=answerLength+words[i].columnindex,allowLength=parseInt(colsNum),invalidWord=""===words[i].clue.trim();row++,column++,invalidWord||(invalidWord=FILTER_REGEX.test(words[i].answer)),words[i].orientation&&(realLength=answerLength+words[i].rowindex,allowLength=parseInt(rowsNum));for(let j=0;j<words[i].answer.length;j++){var _words$i$answer$j$toU;const number=i+1,squareEl=document.querySelector(".grid-row:nth-child("+row+") .grid-square:nth-child("+column+")");if(!squareEl)continue;if(squareEl.classList.add("background-white"),0===j){const labelEl=squareEl.querySelector(".word-label");if(labelEl){var _ref,_words$i2;let label=labelEl.innerText;label+=null!==(_ref=", "+(null===(_words$i2=words[i])||void 0===_words$i2?void 0:_words$i2.no))&&void 0!==_ref?_ref:number,labelEl.innerText=label}else{var _words$i$no,_words$i;let spanEl=document.createElement("span");spanEl.className="word-label",spanEl.innerText=null!==(_words$i$no=null===(_words$i=words[i])||void 0===_words$i?void 0:_words$i.no)&&void 0!==_words$i$no?_words$i$no:number,squareEl.append(spanEl)}}const letter=null!==(_words$i$answer$j$toU=words[i].answer[j].toUpperCase().trim())&&void 0!==_words$i$answer$j$toU?_words$i$answer$j$toU:"",contentEl=squareEl.querySelector("span.word-content");if(contentEl){let text="";const innerText=contentEl.innerText;innerText.search(letter)<0&&(text=innerText+" | "+letter,squareEl.style.backgroundColor=previewSetting.conflictColor,contentEl.innerText=text)}else{let spanEl=document.createElement("span");spanEl.className="word-content",spanEl.innerText=letter,squareEl.append(spanEl)}(invalidWord||realLength>allowLength)&&(squareEl.style.backgroundColor=previewSetting.conflictColor),words[i].orientation?row++:column++}}},CrossWordQuestion.prototype.buildCrossword=function(){const options=this.options;this.options={...options,width:32*options.colsNum+1,height:32*options.rowsNum+1},this.setUpClue(),this.drawCrosswordSVG(),this.syncDataForInit(),this.addEventResizeScreen()},CrossWordQuestion.prototype.setUpClue=function(){let{words:words,readonly:readonly}=this.options;this.crosswordEl.closest(".contain-crossword").querySelectorAll(".contain-clue .wrap-clue").forEach((el=>{const questionId=el.getAttribute("question-id");let word=words.find((o=>o.number===parseInt(questionId)));if(word){const inputEl=el.querySelector("input");inputEl.value+=this.makeUnderscore(word.length-inputEl.value.length),readonly||(inputEl.disabled=!1),this.addEventForClueInput(inputEl,word)}}))},CrossWordQuestion.prototype.drawCrosswordSVG=function(){const options=this.options,crosswordEl=this.crosswordEl;if(!crosswordEl)return;let svg=this.createElementNSFrom("svg",{class:"crossword-grid",viewBox:"0 0 ".concat(options.width," ").concat(options.height)});const rectEl=this.createElementNSFrom("rect",{class:"crossword-grid-background",x:0,y:0,width:options.width,height:options.height});svg.append(rectEl),svg=this.createCrosswordBody(svg);const inputContainEl=this.createElementFrom("div",{class:"crossword-hidden-input-wrapper"}),inputEl=this.createElementFrom("input",{type:"text",class:"crossword-hidden-input",maxlength:1,autocomplete:"off",spellcheck:!1,autocorrect:"off"});this.addEventForWordInput(inputEl),inputContainEl.append(inputEl),crosswordEl.append(svg,inputContainEl)},CrossWordQuestion.prototype.syncDataForInit=function(){const{words:words}=this.options;this.crosswordEl.closest(".contain-crossword").querySelectorAll(".wrap-clue input").forEach((element=>{this.options.wordNumber=parseInt(element.closest(".wrap-clue").getAttribute("question-id"));const word=words.find((o=>o.number===this.options.wordNumber));word&&(this.updateLetterIndexForCells(word),this.syncLettersByText(element.value,!1))})),this.options.wordNumber=-1},CrossWordQuestion.prototype.createCrosswordBody=function(svg){const{words:words,cellWidth:cellWidth,cellHeight:cellHeight}=this.options;let count=0;for(let i in words){const word=words[i];for(let key=0;key<word.length;key++){const customAttribute={rowIndex:word.rowIndex,columnIndex:word.columnIndex,letterIndex:key,word:"("+word.number+")",code:"A"+count},position=this.calculatePosition(word,parseInt(key)),rectEl=this.createElementNSFrom("rect",{...position,width:cellWidth,height:cellHeight,class:"crossword-cell"});let g=this.createElementNSFrom("g",{...customAttribute});const existingRectElement=svg.querySelector("rect.crossword-cell[x='".concat(position.x,"'][y='").concat(position.y,"']")),textEl=this.createElementNSFrom("text",{x:position.x+11,y:position.y+21,class:"crossword-cell-text"});if(existingRectElement){let g,existingNumberElement=existingRectElement.closest("g").querySelector("text.crossword-cell-number"),currentWord=existingRectElement.closest("g").getAttribute("word");existingRectElement.closest("g").setAttributeNS(null,"word",currentWord+"("+word.number+")"),0===parseInt(key)&&(existingNumberElement?existingNumberElement.append(", "+word.number):(g=existingRectElement.closest("g"),this.appendCellNumber(g,position,word.number)))}else g.append(rectEl),0===parseInt(key)&&(g=this.appendCellNumber(g,position,word.number)),g.append(textEl),this.addEventForG(g),count++,svg.append(g)}}return svg},CrossWordQuestion.prototype.calculatePosition=function(word,key){const{cellWidth:cellWidth,cellHeight:cellHeight}=this.options;let x=cellWidth*word.columnIndex+(word.columnIndex+1),y=cellHeight*word.rowIndex+(word.rowIndex+1);return word.orientation?y+=key*cellHeight+key:x+=key*cellWidth+key,{x:x,y:y}},CrossWordQuestion.prototype.appendCellNumber=function(g,position,wordNumber){const x=position.x+1,y=position.y+9;let textNumber=this.createElementNSFrom("text",{x:x,y:y,class:"crossword-cell-number"});return textNumber.append(wordNumber),g.append(textNumber),g},CrossWordQuestion.prototype.handleWordSelect=function(gEl){const currentCell=gEl.getAttributeNS(null,"code");let words=gEl.getAttributeNS(null,"word"),focus=-1,{coordinates:coordinates,wordNumber:wordNumber}=this.options;if(words=words.match(/(\d+)/g),currentCell===coordinates){const indexCell=words.indexOf(wordNumber);focus=void 0!==words[indexCell+1]?words[indexCell+1]:words[0]}else this.options.coordinates=currentCell,wordNumber<0&&(this.options.wordNumber=words[0]),focus=words.includes(wordNumber)?wordNumber:words[0];this.options.wordNumber=focus;const word=this.options.words.find((o=>o.number===parseInt(focus)));word&&(this.updateLetterIndexForCells(word),this.toggleHighlight(word,gEl),this.focusClue(),this.setStickyClue())},CrossWordQuestion.prototype.createElementNSFrom=function(type){let attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const element=document.createElementNS("http://www.w3.org/2000/svg",type);for(let key in attributes)element.setAttributeNS(null,key,attributes[key]);return element},CrossWordQuestion.prototype.createElementFrom=function(type){let attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const element=document.createElement(type);for(let key in attributes)element.setAttribute(key,attributes[key]);return element},CrossWordQuestion.prototype.focusClue=function(){const{wordNumber:wordNumber}=this.options,containCrosswordEl=this.crosswordEl.closest(".contain-crossword"),clueEl=containCrosswordEl.querySelector(".wrap-clue[question-id='".concat(wordNumber,"']")),clueFocusEl=containCrosswordEl.querySelector(".wrap-clue.focus");clueFocusEl&&clueFocusEl.classList.remove("focus"),clueEl&&clueEl.classList.add("focus")},CrossWordQuestion.prototype.setStickyClue=function(){const stickyClue=this.crosswordEl.closest(".contain-crossword").querySelector(".sticky-clue"),{wordNumber:wordNumber,words:words}=this.options,word=words.find((o=>o.number===parseInt(wordNumber)));stickyClue&&word&&(stickyClue.querySelector("strong").innerText="".concat(word.number," ").concat(word.orientation?"Down":"Across"),stickyClue.querySelector("span").innerText=word.clue)},CrossWordQuestion.prototype.updateLetterIndexForCells=function(word){const{wordNumber:wordNumber}=this.options,letterList=this.crosswordEl.querySelectorAll("g[word*='(".concat(wordNumber,")']")),letterListArray=Array.prototype.slice.call(letterList,0);let letterIndex=0;letterListArray.sort(((a,b)=>{let aValue=parseInt(a.querySelector("rect").getAttributeNS(null,"x")),bValue=parseInt(b.querySelector("rect").getAttributeNS(null,"x"));return word.orientation&&(aValue=parseInt(a.querySelector("rect").getAttributeNS(null,"y")),bValue=parseInt(b.querySelector("rect").getAttributeNS(null,"y"))),aValue-bValue})).forEach((el=>{el.setAttributeNS(null,"letterIndex",letterIndex),letterIndex++}))},CrossWordQuestion.prototype.toggleHighlight=function(word,gEl){const{wordNumber:wordNumber,orientation:orientation,title:title}=this.options,focus=wordNumber,focusedEl=this.crosswordEl.querySelector(".crossword-cell-focussed");focusedEl&&focusedEl.classList.remove("crossword-cell-focussed"),this.crosswordEl.querySelectorAll(".crossword-cell-highlighted").forEach((el=>el.classList.remove("crossword-cell-highlighted"))),this.crosswordEl.querySelectorAll("g[word*='(".concat(focus,")'] rect")).forEach((el=>{let titleData="";if(el.closest("g").getAttributeNS(null,"code")===gEl.getAttributeNS(null,"code")){el.classList.add("crossword-cell-focussed");let letterIndex=parseInt(el.closest("g").getAttributeNS(null,"letterIndex"));const data={row:word.rowIndex+1,column:word.columnIndex+letterIndex+1,number:word.number,orientation:orientation[word.orientation],clue:word.clue,letter:letterIndex+1,count:word.length};word.orientation&&(data.row=word.rowIndex+letterIndex+1,data.column=word.columnIndex+1),titleData=this.replaceStringData(title,data),this.crosswordEl.querySelector("input.crossword-hidden-input").setAttributeNS(null,"aria-label",titleData)}else el.classList.add("crossword-cell-highlighted")}))},CrossWordQuestion.prototype.bindDataToClueInput=function(gEl,key){const{words:words,cellWidth:cellWidth,cellHeight:cellHeight}=this.options,rectEl=gEl.querySelector("rect"),conflictPointX=rectEl.getAttributeNS(null,"x"),conflictPointY=rectEl.getAttributeNS(null,"y");let letterIndex,value;if(gEl){gEl.getAttributeNS(null,"word").match(/\d+/g).forEach((wordId=>{const word=words.find((o=>o.number===parseInt(wordId)));if(word){const startPoint=this.calculatePosition(word,0);letterIndex=word.orientation?(parseInt(conflictPointY)-startPoint.y)/(cellHeight+1):(parseInt(conflictPointX)-startPoint.x)/(cellWidth+1);const clueInputEl=this.crosswordEl.closest(".contain-crossword").querySelector(".wrap-clue[question-id='".concat(wordId,"'] input"));value=this.replaceAt(clueInputEl.value,letterIndex,key),clueInputEl.value=value.toUpperCase()}}))}},CrossWordQuestion.prototype.toggleFocus=function(gEl){const focused=this.crosswordEl.querySelector("g rect.crossword-cell-focussed");focused&&(focused.classList.remove("crossword-cell-focussed"),focused.classList.add("crossword-cell-highlighted")),gEl.querySelector("rect").classList.add("crossword-cell-focussed")},CrossWordQuestion.prototype.replaceStringData=function(str,data){for(let key in data)str=str.replace("{".concat(key,"}"),data[key]);return str},CrossWordQuestion.prototype.focusCellByStartIndex=function(startIndex,word){let position=this.calculatePosition(word,startIndex);const rect=this.crosswordEl.querySelector("g rect[x='".concat(position.x,"'][y='").concat(position.y,"']"));rect&&(this.options.wordNumber=word.number,this.toggleHighlight(word,rect.closest("g")),this.updateLetterIndexForCells(word))},CrossWordQuestion.prototype.syncLettersByText=function(text){let bindClue=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{wordNumber:wordNumber}=this.options;for(let i in text){const gEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(i,"']"));if(gEl){const letter=text[i].toUpperCase(),textEl=gEl.querySelector("text.crossword-cell-text");"_"!==text[i]?textEl.innerHTML=letter:textEl.innerHTML="",bindClue&&this.bindDataToClueInput(gEl,letter)}}},CrossWordQuestion.prototype.syncFocusCellAndInput=function(target,startIndex){const{wordNumber:wordNumber}=this.options,gEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(startIndex,"']"));target.setSelectionRange(startIndex,startIndex),gEl&&this.toggleFocus(gEl)},CrossWordQuestion.prototype.replaceText=function(value){return value.replace(FILTER_REGEX,"")},CrossWordQuestion.prototype.addEventForG=function(g){const{readonly:readonly}=this.options;readonly||g.addEventListener("click",(e=>{const inputEl=this.crosswordEl.querySelector(".crossword-hidden-input-wrapper").querySelector("input");let element=e.target;"g"!==element.tagName&&(element=element.closest("g")),this.handleWordSelect(element),inputEl.setAttributeNS(null,"code",element.getAttributeNS(null,"code")),inputEl.value="",this.updatePositionForCellInput(element.querySelector("rect")),inputEl.focus()}))},CrossWordQuestion.prototype.updatePositionForCellInput=function(){let rectEl=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===rectEl&&(rectEl=this.crosswordEl.querySelector("rect.crossword-cell-focussed")),rectEl){const rect=rectEl.getBoundingClientRect(),parentEl=this.crosswordEl.querySelector(".crossword-grid").getBoundingClientRect(),inputWrapperEl=this.crosswordEl.querySelector(".crossword-hidden-input-wrapper");let top=rect.top-parentEl.top;top<1&&(top=1),inputWrapperEl.style.cssText="\n                display: block; top: ".concat(top,"px;\n                left: ").concat(rect.left-parentEl.left,"px;\n                width: ").concat(rect.width,"px;\n                height: ").concat(rect.height,"px\n            ")}},CrossWordQuestion.prototype.addEventForWordInput=function(inputEl){const{readonly:readonly}=this.options;readonly||(inputEl.addEventListener("keypress",(e=>{e.preventDefault();const{wordNumber:wordNumber}=this.options,code=e.target.getAttributeNS(null,"code");let value=e.key.toUpperCase();if(""===this.replaceText(e.key))return!1;if(code){const textEl=this.crosswordEl.querySelector("g[code='".concat(code,"'] text.crossword-cell-text"));if(!textEl)return!1;textEl.innerHTML=value;const letterIndex=parseInt(textEl.closest("g").getAttributeNS(null,"letterIndex")),nextCellEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(letterIndex+1,"']"));this.bindDataToClueInput(textEl.closest("g"),e.key),nextCellEl&&nextCellEl.dispatchEvent(new Event("click"))}})),inputEl.addEventListener("keyup",(event=>{event.preventDefault();const{wordNumber:wordNumber,cellWidth:cellWidth,cellHeight:cellHeight}=this.options,{key:key,target:target}=event,code=target.getAttributeNS(null,"code"),gEl=this.crosswordEl.querySelector("g[code='".concat(code,"']")),letterIndex=parseInt(gEl.getAttributeNS(null,"letterIndex")),previousCell=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(letterIndex-1,"']")),textEl=gEl.querySelector("text.crossword-cell-text");let x=parseInt(gEl.querySelector("rect").getAttributeNS(null,"x")),y=parseInt(gEl.querySelector("rect").getAttributeNS(null,"y"));if("Delete"!==key&&"Backspace"!==key||(""===textEl.innerHTML?previousCell&&previousCell.dispatchEvent(new Event("click")):(textEl.innerHTML="",this.bindDataToClueInput(gEl,"_"))),[ARROW_UP,ARROW_DOWN,ARROW_LEFT,ARROW_RIGHT].includes(key)){key===ARROW_UP&&(y-=cellHeight+1),key===ARROW_DOWN&&(y+=cellHeight+1),key===ARROW_LEFT&&(x-=cellWidth+1),key===ARROW_RIGHT&&(x+=cellWidth+1);const nextCell=this.crosswordEl.querySelector("g rect[x='".concat(x,"'][y='").concat(y,"']"));nextCell&&nextCell.closest("g").dispatchEvent(new Event("click"))}})),inputEl.addEventListener("click",(e=>{const code=e.target.getAttributeNS(null,"code"),gEl=this.crosswordEl.querySelector("g[code='".concat(code,"']"));this.handleWordSelect(gEl)})),inputEl.addEventListener("keydown",(e=>{let{key:key}=e;key=key.toLowerCase(),e.ctrlKey&&("z"!==key&&"a"!==key||e.preventDefault()),"Enter"===e.key&&e.preventDefault()})),inputEl.addEventListener("paste",(e=>{e.preventDefault()})))},CrossWordQuestion.prototype.addEventForClueInput=function(el,word){const{readonly:readonly}=this.options;readonly||(el.addEventListener("click",(e=>{let startIndex=e.target.selectionStart;startIndex>=word.length&&(startIndex=word.length-1),this.focusCellByStartIndex(startIndex,word),this.focusClue(),this.setStickyClue()})),el.addEventListener("focus",(e=>{e.target.dispatchEvent(new Event("click"))})),el.addEventListener("keypress",(e=>{e.preventDefault();const{words:words,wordNumber:wordNumber}=this.options,word=words.find((o=>o.number===parseInt(wordNumber)));let{key:key,target:target}=e,startIndex=target.selectionStart;if(key=this.replaceText(key),""===key)return;const gelEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(startIndex,"']"));gelEl&&(gelEl.querySelector("text.crossword-cell-text").innerHTML=key.toUpperCase(),this.bindDataToClueInput(gelEl,key.toUpperCase())),startIndex++;const nexEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(startIndex,"']"));nexEl&&(this.toggleHighlight(word,nexEl),target.setSelectionRange(startIndex,startIndex))})),el.addEventListener("keyup",(event=>{event.preventDefault();const{words:words,wordNumber:wordNumber}=this.options,{key:key,target:target}=event;let{value:value}=target;if([ARROW_LEFT,ARROW_RIGHT].includes(key)){const startIndex=target.selectionStart,gEl=this.crosswordEl.querySelector("g[word*='(".concat(wordNumber,")'][letterIndex='").concat(startIndex,"']"));gEl&&this.toggleHighlight(word,gEl)}if("Delete"===key||"Backspace"===key){const word=words.find((o=>o.number===parseInt(wordNumber)));let startIndex=target.selectionStart;if(!word)return;value+=this.makeUnderscore(word.length-value.length),target.value=value,this.syncLettersByText(value),this.syncFocusCellAndInput(target,startIndex)}if("End"===key||"Home"===key){let startIndex=0;const word=words.find((o=>o.number===parseInt(wordNumber)));if(!word)return;"End"===key&&(startIndex=word.length-1),this.syncFocusCellAndInput(target,startIndex)}})),el.addEventListener("paste",(event=>{event.preventDefault();let value=(event.clipboardData||window.clipboardData).getData("text");value=this.replaceText(value),this.syncLettersByText(value)})),el.addEventListener("keydown",(e=>{e.ctrlKey&&"z"===e.key.toLowerCase()&&e.preventDefault(),"Enter"===e.key&&e.preventDefault()})),el.addEventListener("cut",(event=>{const selectString=document.getSelection().toString(),startIndex=event.target.selectionStart;let{value:value}=event.target;value=value.substring(0,startIndex)+value.substring(startIndex+selectString.length)+this.makeUnderscore(selectString.length),event.target.value=value,event.clipboardData.setData("text/plain",selectString),event.preventDefault(),event.target.setSelectionRange(startIndex,startIndex),this.syncLettersByText(value)})))},CrossWordQuestion.prototype.addEventResizeScreen=function(){window.addEventListener("resize",(()=>{this.updatePositionForCellInput()}))},CrossWordQuestion.prototype.makeUnderscore=function(length){return Array.from({length:length},(()=>"_")).join("")},CrossWordQuestion.prototype.replaceAt=function(text,index,char){var a=text.split("");return void 0!==a[index]&&(a[index]=char),a.join("")};const questionManager={init:function(options){const crossword=new CrossWordQuestion(options);options.isPreview?(crossword.buildBackgroundTable(),crossword.addCell()):crossword.buildCrossword()},addEventHandlersReloadQuestion:function(options){const element=document.querySelector(options.element);element&&(element.removeAttribute("disabled"),element.addEventListener("click",(function(event){event.preventDefault();const columnEl=document.querySelector('select[name="numcolumns"]'),rowEl=document.querySelector('select[name="numrows"]'),words=questionManager.getWordsFromTable(options.target),settings={...options,words:words,colsNum:columnEl.options[columnEl.selectedIndex].text,rowsNum:rowEl.options[rowEl.selectedIndex].text};questionManager.init(settings)})))},getWordsFromTable:function(){const answersEl=document.querySelectorAll("fieldset#id_wordhdr .fcontainer .form-group.row"),alphaRegex=/^[a-z]+/;let words=[],i=0,no=0,word={};return answersEl?(answersEl.forEach((obj=>{let inputEl=obj.querySelectorAll('input[type="text"]'),selectEl=obj.querySelectorAll("select");inputEl.length>0&&inputEl.forEach((inputEl=>{var _inputEl$name$match;const name=null===(_inputEl$name$match=inputEl.name.match(alphaRegex))||void 0===_inputEl$name$match?void 0:_inputEl$name$match.pop();word[name]=inputEl.value.trim()})),selectEl.length>0&&selectEl.forEach((selectEl=>{var _selectEl$name$match;const name=null===(_selectEl$name$match=selectEl.name.match(alphaRegex))||void 0===_selectEl$name$match?void 0:_selectEl$name$match.pop();word[name]=selectEl.selectedIndex})),i++,0!==i&&i%2==0&&(no++,word.no=no,words.push(word),word={})})),words):words}};return{init:questionManager.init,addEventHandlersReloadQuestion:questionManager.addEventHandlersReloadQuestion}}));

//# sourceMappingURL=crossword.min.js.map